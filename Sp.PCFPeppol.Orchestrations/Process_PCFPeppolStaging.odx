#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="ae6e25dc-822b-4ac6-a3c4-d64f419f7ef3" LowerBound="1.1" HigherBound="398.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="Sp.PCFPeppol.Orchestrations" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="2c50d9e5-48c7-467a-a982-cbca3b7510cd" ParentLink="Module_PortType" LowerBound="12.1" HigherBound="19.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_RcvPCFPeppolXML" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="0509c499-08a1-4375-a707-fae37b2e206d" ParentLink="PortType_OperationDeclaration" LowerBound="14.1" HigherBound="18.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="2a194451-06a9-4622-af1f-ec97b2a46c5d" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="16.13" HigherBound="16.45">
                    <om:Property Name="Ref" Value="Sp.PCFPeppol.Schemas.PeppolInput" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="7acb255e-6326-4d5e-a9e9-f726e7dff088" ParentLink="Module_PortType" LowerBound="19.1" HigherBound="26.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SndPCFPeppolErrorLogs" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="ada68ccb-c86c-4d9d-a721-e2f4be41f2b4" ParentLink="PortType_OperationDeclaration" LowerBound="21.1" HigherBound="25.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="bb1042fe-e2b5-4719-8710-7efbb09b3f74" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="23.13" HigherBound="23.27">
                    <om:Property Name="Ref" Value="Sp.PCFPeppol.Orchestrations.MultiErrorLogs" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="53498586-f2e7-4657-8b49-ed8a9d7e3820" ParentLink="Module_PortType" LowerBound="26.1" HigherBound="33.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SndPCFPeppolXML" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="d45af582-aec5-48a3-8d54-6d6b1873f581" ParentLink="PortType_OperationDeclaration" LowerBound="28.1" HigherBound="32.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="88f77b46-885c-476e-a76d-ffffcb00fc34" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="30.13" HigherBound="30.45">
                    <om:Property Name="Ref" Value="Sp.PCFPeppol.Schemas.PeppolInput" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="23f9f94f-7e5a-4f21-9781-a9d064f15983" ParentLink="Module_PortType" LowerBound="33.1" HigherBound="40.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SndRcvPCFPeppolStaging" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="7b33381a-d5df-4821-8861-c9f35b79c44e" ParentLink="PortType_OperationDeclaration" LowerBound="35.1" HigherBound="39.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="654ae3c3-8de8-4bee-bb3e-d9afccb5844a" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="37.13" HigherBound="37.98">
                    <om:Property Name="Ref" Value="Sp.PCFPeppol.Schemas.uspPCFPeppolStaging_TypedProcedure_dbo.InterfacePCFPeppolStaging" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="3bb028d2-7e7d-4a33-9e1c-d0d5617b6d7f" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="37.100" HigherBound="37.193">
                    <om:Property Name="Ref" Value="Sp.PCFPeppol.Schemas.uspPCFPeppolStaging_TypedProcedure_dbo.InterfacePCFPeppolStagingResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="70234f4b-5074-4009-b663-19642c7dff14" ParentLink="Module_PortType" LowerBound="40.1" HigherBound="47.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SndPCFPeppolXMLErrorEmail" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="9d6367e5-7228-40a4-a973-1e6c91f80566" ParentLink="PortType_OperationDeclaration" LowerBound="42.1" HigherBound="46.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="8ea21668-3617-4939-a617-b9bf528313ff" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="44.13" HigherBound="44.28">
                    <om:Property Name="Ref" Value="Sp.PCFPeppol.Orchestrations.MultiErrorEmail" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="df930b8a-bd2f-48e6-85a4-4770576e956a" ParentLink="Module_MessageType" LowerBound="4.1" HigherBound="8.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultiErrorEmail" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="cc1236d6-c863-41e2-85a8-fe5372232373" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="6.1" HigherBound="7.1">
                <om:Property Name="ClassName" Value="Sp.PCFPeppol.Common.RawString" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="ba8d2cac-b1cd-4e05-a379-e2244f4ea26e" ParentLink="Module_MessageType" LowerBound="8.1" HigherBound="12.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultiErrorLogs" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="afb5184e-b057-49b9-8f21-5bc8e5729ac9" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="10.1" HigherBound="11.1">
                <om:Property Name="ClassName" Value="Sp.PCFPeppol.Schemas.uspErrorLogs_TypedProcedure_docdata.InterfaceErrorLogs" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="7d09ab58-89a8-4946-99a2-b153f89832f9" ParentLink="Module_ServiceDeclaration" LowerBound="47.1" HigherBound="397.1">
            <om:Property Name="InitializedTransactionType" Value="False" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="Process_PCFPeppolStaging" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="VariableDeclaration" OID="5e350a12-26ae-48ce-8e38-c2639a3d3f8f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="67.1" HigherBound="68.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTotalTaxAmount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b20a8a4e-178b-4983-8527-908b7f1ad63c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="68.1" HigherBound="69.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailBody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9b0dbd66-2739-47ec-9444-2b5c6f1462bd" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="69.1" HigherBound="70.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varAccCustEndpointId" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="020c5a9b-aeb4-49c3-8068-aec52f16aef8" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="70.1" HigherBound="71.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varAccSuppEndpointId" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="278668b9-506c-4407-b52c-e1e4f451e4cd" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="71.1" HigherBound="72.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varOrderReferenceId" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="676142bb-156c-4a46-86f3-1c2d34bed57c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="72.1" HigherBound="73.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varInvoiceTypeCode" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="dfd867c8-7d8c-4f3b-bd92-72df881949ca" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="73.1" HigherBound="74.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDocumentNumber" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="de9fd810-6a72-4e3f-93d6-dd3b893f9f4e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="74.1" HigherBound="75.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varIssueDate" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="be65c6cb-daf6-43f7-964d-242771148933" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="75.1" HigherBound="76.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varReceiverIdentifier" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ddce7613-cfa8-4a0a-a44f-06b8862ae826" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="76.1" HigherBound="77.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSenderIdentifier" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="3289c41d-c67c-4e79-8fbd-ce4937b3dfcb" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="77.1" HigherBound="78.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUUID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c7674f88-ba57-4c6f-b1f6-5a2ed240021e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="78.1" HigherBound="79.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varInstanceIdentifier" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="64ce63e9-eecd-4711-9734-a1f98268f5ae" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="79.1" HigherBound="80.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTempXML" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4a12a994-2653-4cc3-acca-a0e3ba5c08ac" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="80.1" HigherBound="81.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSPResp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="46005b73-e687-46d1-b589-13bc68478d7c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="81.1" HigherBound="82.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varExceptionmsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="a4e33170-d83b-4c18-8ce8-12a3a40d4551" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="82.1" HigherBound="83.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varGRNNumber" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="340dd373-5cc3-4448-9ab9-1c7e5f6a1996" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="83.1" HigherBound="84.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varFilePath" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="08bd8363-ad6b-4398-a267-3db21e8c920f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="84.1" HigherBound="85.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSenderRegName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="68697977-5195-45ad-8da5-8216b3296831" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="85.1" HigherBound="86.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varReceiverRegName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="791fe028-f4d3-446e-a2b9-924a49c29aea" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="86.1" HigherBound="87.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDatetime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="249d8fa2-5631-4b94-a033-1facafe40127" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="87.1" HigherBound="88.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varFullpath" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d55f223b-c2ae-4411-921d-2f6669086405" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="88.1" HigherBound="89.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTotalQty" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8c3cc8d6-b559-4cda-b327-f04f247fe4e5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="89.1" HigherBound="90.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTotalAmount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="3a0babf4-e4d1-4837-85a9-dd73f45fb6ae" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="90.1" HigherBound="91.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSupplierEmail" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="cdf44320-c1fd-4496-9b3f-ead5c1dda2b2" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="91.1" HigherBound="92.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varInvoiceHeaderText" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="fb38394c-6dec-4991-a234-69f7d1762319" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="92.1" HigherBound="93.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCreditNoteInvRefNo" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d57a55d6-7567-4c71-bab9-bcdbf580a4cf" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="93.1" HigherBound="94.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTaxExclusiveAmount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="482a4135-1f78-46b1-bd2a-3a1134d86701" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="94.1" HigherBound="95.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTaxInclusiveAmount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2dd8ff26-3281-4b5e-a3a6-3df8ce50332b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="95.1" HigherBound="96.1">
                <om:Property Name="InitialValue" Value="0" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varInvLineCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d983eb32-f10a-45bf-bef5-af8b5a42883f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="96.1" HigherBound="97.1">
                <om:Property Name="InitialValue" Value="0" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varchkGRCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="562d1d77-89b4-4890-89a1-83d2884cb5d3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="97.1" HigherBound="98.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varPreChkGRNo" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ec0ef0be-7e12-4305-8ab8-055ebfe7fa32" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="98.1" HigherBound="99.1">
                <om:Property Name="InitialValue" Value="0" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varGRNCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="1611a49f-cb44-439e-b163-c5fd8b5f2a5a" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="60.1" HigherBound="61.1">
                <om:Property Name="Type" Value="Sp.PCFPeppol.Orchestrations.MultiErrorLogs" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgErrorLogs" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="8b695823-29d7-45c0-af33-af5cc882786e" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="61.1" HigherBound="62.1">
                <om:Property Name="Type" Value="Sp.PCFPeppol.Orchestrations.MultiErrorEmail" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgErrorEmail" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="cd03308c-3184-4fef-ab28-7a2a119a15c5" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="62.1" HigherBound="63.1">
                <om:Property Name="Type" Value="Sp.PCFPeppol.Schemas.PeppolInput" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgPeppolXML" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="2876d95a-5d01-44a3-8166-8da2331f2048" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="63.1" HigherBound="64.1">
                <om:Property Name="Type" Value="Sp.PCFPeppol.Schemas.uspPCFPeppolStaging_TypedProcedure_dbo.InterfacePCFPeppolStaging" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msguspReq" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="920d430c-e98f-4164-8456-939c0780604b" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="64.1" HigherBound="65.1">
                <om:Property Name="Type" Value="Sp.PCFPeppol.Schemas.uspPCFPeppolStaging_TypedProcedure_dbo.InterfacePCFPeppolStagingResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msguspResp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="d62bae90-5118-4540-81ed-9df9caae40c2" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="65.1" HigherBound="66.1">
                <om:Property Name="Type" Value="Sp.PCFPeppol.Schemas.PeppolInput" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgPeppolXMLCopy" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="51e8ff62-c525-4aec-9742-d6a6811b0443" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="66.1" HigherBound="67.1">
                <om:Property Name="Type" Value="Sp.PCFPeppol.Schemas.PCFPeppolInternalXML" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgInternalXML" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="e49fb619-5590-4f93-9f91-48b1347f4418" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="adfd31fc-001a-4f31-bda0-c5da854d44d2" ParentLink="ServiceBody_Statement" LowerBound="101.1" HigherBound="135.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="Port_RcvPCFPeppolXML" />
                    <om:Property Name="MessageName" Value="msgPeppolXML" />
                    <om:Property Name="OperationName" Value="Operation_1" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Receive_1" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="VariableAssignment" OID="2690e6f3-01f3-4360-8a4a-c4e52639799c" ParentLink="ServiceBody_Statement" LowerBound="135.1" HigherBound="137.1">
                    <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;PCFPeppol Process start&quot;,&quot;PCFPeppol Process started&quot;);" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="ProcessStart" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="Scope" OID="8d3eb18c-4db6-44d2-85cd-95f57fe46741" ParentLink="ServiceBody_Statement" LowerBound="137.1" HigherBound="393.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="False" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Process_PeppolXML" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="Construct" OID="f1f9d363-54c2-4954-899e-64c1d2b1aab8" ParentLink="ComplexStatement_Statement" LowerBound="142.1" HigherBound="148.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Const_PeppolXML_PCFPeppol" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Transform" OID="2b386416-41e0-4c13-8547-5d6bce21de8a" ParentLink="ComplexStatement_Statement" LowerBound="145.1" HigherBound="147.1">
                            <om:Property Name="ClassName" Value="Sp.PCFPeppol.Transforms.Map_PeppolXML_PCFPeppolInternal" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Transform_1" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessagePartRef" OID="49ba1126-06b4-49f1-b099-e7cc4dc3c55c" ParentLink="Transform_InputMessagePartRef" LowerBound="146.111" HigherBound="146.123">
                                <om:Property Name="MessageRef" Value="msgPeppolXML" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_1" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="b65aa481-4372-49a6-b409-d5670c4d5864" ParentLink="Transform_OutputMessagePartRef" LowerBound="146.36" HigherBound="146.50">
                                <om:Property Name="MessageRef" Value="msgInternalXML" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_2" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="MessageRef" OID="12f8300f-d4c1-4778-b6a0-e404aa355529" ParentLink="Construct_MessageRef" LowerBound="143.31" HigherBound="143.45">
                            <om:Property Name="Ref" Value="msgInternalXML" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="af67d981-f8c3-4b95-bcb6-df7dfb1d85d7" ParentLink="ComplexStatement_Statement" LowerBound="148.1" HigherBound="218.1">
                        <om:Property Name="Expression" Value="varInstanceIdentifier = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='StandardBusinessDocumentHeader']/*[local-name()='DocumentIdentification']/*[local-name()='InstanceIdentifier'])&quot;);&#xD;&#xA;varSenderIdentifier = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='StandardBusinessDocumentHeader']/*[local-name()='Sender']/*[local-name()='Identifier'])&quot;);&#xD;&#xA;varSenderRegName = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='AccountingSupplierParty']/*[local-name()='Party']/*[local-name()='PartyLegalEntity']/*[local-name()='RegistrationName'])&quot;);&#xD;&#xA;varReceiverIdentifier = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='StandardBusinessDocumentHeader']/*[local-name()='Receiver']/*[local-name()='Identifier'])&quot;);&#xD;&#xA;varReceiverRegName = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='AccountingCustomerParty']/*[local-name()='Party']/*[local-name()='PartyLegalEntity']/*[local-name()='RegistrationName'])&quot;);&#xD;&#xA;varUUID = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='UUID'])&quot;);&#xD;&#xA;&#xD;&#xA;varAccSuppEndpointId = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='AccountingSupplierParty']/*[local-name()='Party']/*[local-name()='PartyIdentification']/*[local-name()='ID'])&quot;);&#xD;&#xA;varAccCustEndpointId = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='AccountingCustomerParty']/*[local-name()='Party']/*[local-name()='PartyIdentification']/*[local-name()='ID'])&quot;);&#xD;&#xA;&#xD;&#xA;varIssueDate = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='IssueDate'])&quot;);&#xD;&#xA;varDocumentNumber = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='ID'])&quot;);&#xD;&#xA;varInvoiceTypeCode = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='InvoiceTypeCode'])&quot;);&#xD;&#xA;varOrderReferenceId = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='OrderReference']/*[local-name()='ID'])&quot;);&#xD;&#xA;varGRNNumber = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='InvoiceLine']/*[local-name()='DocumentReference']/*[local-name()='ID'])&quot;);&#xD;&#xA;varCreditNoteInvRefNo = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='BillingReference']/*[local-name()='InvoiceDocumentReference']/*[local-name()='ID'])&quot;);&#xD;&#xA;varSupplierEmail = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='AccountingSupplierParty']/*[local-name()='Party']/*[local-name()='Contact']/*[local-name()='ElectronicMail'])&quot;);&#xD;&#xA;varInvoiceHeaderText = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='Note'])&quot;);&#xD;&#xA;&#xD;&#xA;varTotalQty = xpath(msgInternalXML,&quot;string(sum(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='InvoiceLine']/*[local-name()='InvoicedQuantity']))&quot;);&#xD;&#xA;varTotalAmount = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='LegalMonetaryTotal']/*[local-name()='PayableAmount'])&quot;);&#xD;&#xA;varTaxExclusiveAmount = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='LegalMonetaryTotal']/*[local-name()='TaxExclusiveAmount'])&quot;);&#xD;&#xA;varTaxInclusiveAmount = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='LegalMonetaryTotal']/*[local-name()='TaxInclusiveAmount'])&quot;);&#xD;&#xA;varTotalTaxAmount = xpath(msgInternalXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='TaxTotal']/*[local-name()='TaxAmount'])&quot;);&#xD;&#xA;&#xD;&#xA;if(System.Convert.ToString(Sp.PCFPeppol.Common.SSOClientHelper.Read(&quot;Sp.PCFPeppol&quot;, &quot;ShowAdminLogs&quot;)) == &quot;Yes&quot;)&#xD;&#xA;{&#xD;&#xA;    varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;    varTempXML = msgPeppolXML;&#xD;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xD;&#xA;    {&#xD;&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgpeppolxml&quot;,varTempXML.OuterXml);&#xD;&#xA;    }&#xD;&#xA;    else&#xD;&#xA;    {&#xD;&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgpeppolxml&quot;,varTempXML.OuterXml.Substring(1,29500));&#xD;&#xA;    }&#xD;&#xA;    varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;    varTempXML = msgInternalXML;&#xD;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xD;&#xA;    {&#xD;&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgInternalXML&quot;,varTempXML.OuterXml);&#xD;&#xA;    }&#xD;&#xA;    else&#xD;&#xA;    {&#xD;&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msgInternalXML&quot;,varTempXML.OuterXml.Substring(1,29500));&#xD;&#xA;    }&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varInstanceIdentifier&quot;,varInstanceIdentifier);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varSenderIdentifier&quot;,varSenderIdentifier);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;SenderRegName&quot;,varSenderRegName);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varReceiverIdentifier&quot;,varReceiverIdentifier);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;ReceiverRegName&quot;,varReceiverRegName);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varUUID&quot;,varUUID);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varAccSuppEndpointId&quot;,varAccSuppEndpointId);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varAccCustEndpointId&quot;,varAccCustEndpointId);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varIssueDate&quot;,varIssueDate);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varDocumentNumber&quot;,varDocumentNumber);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varInvoiceTypeCode&quot;,varInvoiceTypeCode);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varOrderReferenceId&quot;,varOrderReferenceId);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varGRNNumber&quot;,varGRNNumber);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;varCreditNoteInvRefNo&quot;,varCreditNoteInvRefNo);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;SupplierEmail&quot;,varSupplierEmail);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;InvoiceHeaderText&quot;,varInvoiceHeaderText);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;TotalQty&quot;,varTotalQty);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;TotalAmount&quot;,varTotalAmount);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;TotalTaxAmount&quot;,varTotalTaxAmount);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;TaxExclusiveAmount&quot;,varTaxExclusiveAmount);&#xD;&#xA;    System.Diagnostics.EventLog.WriteEntry(&quot;TaxInclusiveAmount&quot;,varTaxInclusiveAmount);&#xD;&#xA;}&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Assign_var" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="93fa962f-7fc4-43f0-9d9f-30f3ebd2a453" ParentLink="ComplexStatement_Statement" LowerBound="218.1" HigherBound="228.1">
                        <om:Property Name="Expression" Value="varFilePath = Sp.PCFPeppol.Common.SSOClientHelper.Read(&quot;Sp.PCFPeppol&quot;, &quot;PeppolXMLPath&quot;);&#xD;&#xA;varDatetime = System.DateTime.Now.ToString(&quot;yyyyMMdd&quot;);&#xD;&#xA;varFullpath = varFilePath + &quot;\\&quot; + varDatetime;&#xD;&#xA;if (!System.IO.Directory.Exists(varFullpath))&#xD;&#xA;{&#xD;&#xA;    System.IO.Directory.CreateDirectory(varFullpath);&#xD;&#xA;}&#xD;&#xA;Port_SndPCFPeppolXML(Microsoft.XLANGs.BaseTypes.Address)=@varFullpath + &quot;\\&quot;+varInstanceIdentifier+&quot;.xml&quot;;&#xD;&#xA;Port_SndPCFPeppolXML(Microsoft.XLANGs.BaseTypes.TransportType)=&quot;FILE&quot;;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="PeppolXML" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Construct" OID="93c7ce36-9369-4c7a-81b6-a5a5256e2261" ParentLink="ComplexStatement_Statement" LowerBound="228.1" HigherBound="235.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Const_PeppolXML" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageAssignment" OID="0573a798-c8c8-43fb-91da-cf4714a4ba0a" ParentLink="ComplexStatement_Statement" LowerBound="231.1" HigherBound="234.1">
                            <om:Property Name="Expression" Value="msgPeppolXMLCopy = msgPeppolXML;&#xD;&#xA;msgPeppolXMLCopy(FILE.CopyMode) = 2; //overwrite;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_2" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="MessageRef" OID="022c665b-19e0-45e5-8d21-01e2b490b700" ParentLink="Construct_MessageRef" LowerBound="229.31" HigherBound="229.47">
                            <om:Property Name="Ref" Value="msgPeppolXMLCopy" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Send" OID="d28f5d37-d290-4330-88a3-4c81a4285813" ParentLink="ComplexStatement_Statement" LowerBound="235.1" HigherBound="237.1">
                        <om:Property Name="PortName" Value="Port_SndPCFPeppolXML" />
                        <om:Property Name="MessageName" Value="msgPeppolXMLCopy" />
                        <om:Property Name="OperationName" Value="Operation_1" />
                        <om:Property Name="OperationMessageName" Value="Request" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Send_3" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Construct" OID="ecf07bdc-70bd-42a9-bd2e-e0a9f21a2c65" ParentLink="ComplexStatement_Statement" LowerBound="237.1" HigherBound="246.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Const_Insert_DB" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageAssignment" OID="83456d75-3708-4c73-b331-da95d7198796" ParentLink="ComplexStatement_Statement" LowerBound="240.1" HigherBound="245.1">
                            <om:Property Name="Expression" Value="varFullpath = varFullpath+ &quot;\\&quot;+varInstanceIdentifier+&quot;.xml&quot;;&#xD;&#xA;varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;varTempXML.LoadXml(&quot;&lt;ns0:InterfacePCFPeppolStaging xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'&gt;&lt;ns0:InstanceIdentifier&gt;&quot; + varInstanceIdentifier + &quot;&lt;/ns0:InstanceIdentifier&gt;&lt;ns0:UUID&gt;&quot; + varUUID + &quot;&lt;/ns0:UUID&gt;&lt;ns0:SenderIdentifer&gt;&quot; + varSenderIdentifier + &quot;&lt;/ns0:SenderIdentifer&gt;&lt;ns0:SenderRegName&gt;&quot; + varSenderRegName + &quot;&lt;/ns0:SenderRegName&gt;&lt;ns0:ReceiverIdentifer&gt;&quot; + varReceiverIdentifier + &quot;&lt;/ns0:ReceiverIdentifer&gt;&lt;ns0:ReceiverRegName&gt;&quot; + varReceiverRegName + &quot;&lt;/ns0:ReceiverRegName&gt;&lt;ns0:IssueDate&gt;&quot; + varIssueDate + &quot;&lt;/ns0:IssueDate&gt;&lt;ns0:DocumentNumber&gt;&quot; + varDocumentNumber + &quot;&lt;/ns0:DocumentNumber&gt;&lt;ns0:InvoiceTypeCode&gt;&quot; + varInvoiceTypeCode + &quot;&lt;/ns0:InvoiceTypeCode&gt;&lt;ns0:OrderReferenceId&gt;&quot; + varOrderReferenceId + &quot;&lt;/ns0:OrderReferenceId&gt;&lt;ns0:GRNNumber&gt;&quot; + varGRNNumber + &quot;&lt;/ns0:GRNNumber&gt;&lt;ns0:AcctSuppPartyEndpointId&gt;&quot; + varAccSuppEndpointId + &quot;&lt;/ns0:AcctSuppPartyEndpointId&gt;&lt;ns0:AcctCustPartyEndpointId&gt;&quot; + varAccCustEndpointId + &quot;&lt;/ns0:AcctCustPartyEndpointId&gt;&lt;ns0:SupplierEmail&gt;&quot; + varSupplierEmail + &quot;&lt;/ns0:SupplierEmail&gt;&lt;ns0:InvoiceHeaderText&gt;&quot; + varInvoiceHeaderText + &quot;&lt;/ns0:InvoiceHeaderText&gt;&lt;ns0:CreditNoteInvRefNo&gt;&quot; + varCreditNoteInvRefNo + &quot;&lt;/ns0:CreditNoteInvRefNo&gt;&lt;ns0:TotalQty&gt;&quot; + varTotalQty + &quot;&lt;/ns0:TotalQty&gt;&lt;ns0:TotalAmount&gt;&quot; + varTotalAmount + &quot;&lt;/ns0:TotalAmount&gt;&lt;ns0:TaxExclusiveAmount&gt;&quot; + varTaxExclusiveAmount + &quot;&lt;/ns0:TaxExclusiveAmount&gt;&lt;ns0:TaxInclusiveAmount&gt;&quot; + varTaxInclusiveAmount + &quot;&lt;/ns0:TaxInclusiveAmount&gt;&lt;ns0:TotalTaxAmount&gt;&quot; + varTotalTaxAmount + &quot;&lt;/ns0:TotalTaxAmount&gt;&lt;ns0:PeppolXMLPath&gt;&quot; + varFullpath + &quot;&lt;/ns0:PeppolXMLPath&gt;&lt;/ns0:InterfacePCFPeppolStaging&gt;&quot;);&#xD;&#xA;msguspReq = varTempXML;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_4" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageRef" OID="39117d05-e144-4516-b7bd-9b8332f0fa0c" ParentLink="Construct_MessageRef" LowerBound="238.31" HigherBound="238.40">
                            <om:Property Name="Ref" Value="msguspReq" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="b9e7b907-353c-4c59-a996-fa60b9cd5f0c" ParentLink="ComplexStatement_Statement" LowerBound="246.1" HigherBound="260.1">
                        <om:Property Name="Expression" Value="if(System.Convert.ToString(Sp.PCFPeppol.Common.SSOClientHelper.Read(&quot;Sp.PCFPeppol&quot;, &quot;ShowAdminLogs&quot;)) == &quot;Yes&quot;)&#xD;&#xA;{&#xD;&#xA;    varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;    varTempXML = msguspReq;    &#xD;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xD;&#xA;    {&#xD;&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msguspReq&quot;,varTempXML.OuterXml);&#xD;&#xA;    }&#xD;&#xA;    else&#xD;&#xA;    {&#xD;&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msguspReq&quot;,varTempXML.OuterXml.Substring(1,29500));&#xD;&#xA;    }&#xD;&#xA;}" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="PrintLogs" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Send" OID="b47ecb05-df53-4a83-8415-93a9fa6e18f8" ParentLink="ComplexStatement_Statement" LowerBound="260.1" HigherBound="262.1">
                        <om:Property Name="PortName" Value="Port_SndRcvPCFPeppolStaging" />
                        <om:Property Name="MessageName" Value="msguspReq" />
                        <om:Property Name="OperationName" Value="Operation_1" />
                        <om:Property Name="OperationMessageName" Value="Request" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Send_4" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Receive" OID="13ee63c2-8bdf-440c-bda2-c48d709e1492" ParentLink="ComplexStatement_Statement" LowerBound="262.1" HigherBound="264.1">
                        <om:Property Name="Activate" Value="False" />
                        <om:Property Name="PortName" Value="Port_SndRcvPCFPeppolStaging" />
                        <om:Property Name="MessageName" Value="msguspResp" />
                        <om:Property Name="OperationName" Value="Operation_1" />
                        <om:Property Name="OperationMessageName" Value="Response" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Receive_2" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="c91cfe06-ee10-4f70-8daa-2febe958abdc" ParentLink="ComplexStatement_Statement" LowerBound="264.1" HigherBound="279.1">
                        <om:Property Name="Expression" Value="if(System.Convert.ToString(Sp.PCFPeppol.Common.SSOClientHelper.Read(&quot;Sp.PCFPeppol&quot;, &quot;ShowAdminLogs&quot;)) == &quot;Yes&quot;)&#xD;&#xA;{&#xD;&#xA;    varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;    varTempXML = msguspResp;    &#xD;&#xA;    if(varTempXML.OuterXml.Length &lt; 30000)&#xD;&#xA;    {&#xD;&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msguspResp&quot;,varTempXML.OuterXml);&#xD;&#xA;    }&#xD;&#xA;    else&#xD;&#xA;    {&#xD;&#xA;        System.Diagnostics.EventLog.WriteEntry(&quot;msguspResp&quot;,varTempXML.OuterXml.Substring(1,29500));&#xD;&#xA;    }&#xD;&#xA;}&#xD;&#xA;varSPResp = xpath(msguspResp,&quot;string(/*[local-name()='InterfacePCFPeppolStagingResponse']/*[local-name()='StoredProcedureResultSet1']/*[local-name()='StoredProcedureResultSet1']/*[local-name()='resDescription'])&quot;);" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="SP_Resp" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Decision" OID="f942b02a-3816-4ecc-818c-b32e68990f90" ParentLink="ComplexStatement_Statement" LowerBound="279.1" HigherBound="336.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Chk_if_StoredProc_Error" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="026e2949-4338-41c9-abfc-cbdb26b3de54" ParentLink="ReallyComplexStatement_Branch" LowerBound="280.21" HigherBound="331.1">
                            <om:Property Name="Expression" Value="varSPResp == &quot;OK&quot;" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="If_Success" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="VariableAssignment" OID="7cc95355-20a6-420b-b557-bdafe85f41d4" ParentLink="ComplexStatement_Statement" LowerBound="282.1" HigherBound="294.1">
                                <om:Property Name="Expression" Value="varInvLineCount = System.Convert.ToInt32(xpath(msgPeppolXML,&quot;count(/*[local-name()='StandardBusinessDocument' and namespace-uri()='http://www.unece.org/cefact/namespaces/StandardBusinessDocumentHeader']/*[local-name()='Invoice' and namespace-uri()='urn:oasis:names:specification:ubl:schema:xsd:Invoice-2']/*[local-name()='InvoiceLine' and namespace-uri()='urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2'])&quot;));&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;InvoiceLineCount&quot;,varInvLineCount.ToString());&#xD;&#xA;&#xD;&#xA;//varInvLineCount = System.Convert.ToInt32(xpath(msgPeppolXML,&quot;count(/*[local-name()='StandardBusinessDocument' and namespace-uri()='http://www.unece.org/cefact/namespaces/StandardBusinessDocumentHeader']/*[local-name()='CreditNote' and namespace-uri()='urn:oasis:names:specification:ubl:schema:xsd:CreditNote-2']/*[local-name()='CreditNoteLine' and namespace-uri()='urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2'])&quot;));&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;CreditLineCount&quot;,varInvLineCount.ToString());&#xD;&#xA;&#xD;&#xA;varGRNNumber = xpath(msgPeppolXML,&quot;string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='InvoiceLine']/*[local-name()='DocumentReference']/*[local-name()='ID'])&quot;);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;GRNNumber&quot;,varGRNNumber);&#xD;&#xA;&#xD;&#xA;varGRNCount = System.Convert.ToInt32(xpath(msgPeppolXML,&quot;count(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='InvoiceLine']/*[local-name()='DocumentReference']/*[local-name()='ID']/text()[contains(.,'&quot; + varGRNNumber + &quot;')])&quot;));&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;GRNCount&quot;,varGRNCount.ToString());&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Check_GRN_Validation" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Decision" OID="7477369b-cc45-4018-957e-dea15d479f93" ParentLink="ComplexStatement_Statement" LowerBound="294.1" HigherBound="330.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Chk_GRN_Match_For_Invoice" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="d90f086e-6988-4405-8b85-371c41d9e829" ParentLink="ReallyComplexStatement_Branch" LowerBound="295.25" HigherBound="298.1">
                                    <om:Property Name="Expression" Value="(((varInvLineCount &gt; 0) &amp; (varInvLineCount == varGRNCount)) || (varInvLineCount == 0) || (varGRNCount == 0))" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="If_1_GRN" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="a83fe8ca-c3fa-420d-a710-87c4f3351301" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="VariableAssignment" OID="62b9f7ab-5411-42f3-afc8-1a4388d23391" ParentLink="ComplexStatement_Statement" LowerBound="300.1" HigherBound="302.1">
                                        <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;GRN and Invoice Mismatch&quot;,&quot;GRN and Invoice Mismatch&quot;);" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="SndEmail" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="Construct" OID="52583a1e-fe2b-45f0-a072-2a2b21fd2fbb" ParentLink="ComplexStatement_Statement" LowerBound="302.1" HigherBound="327.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_2" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="41a49953-4086-4a94-9427-68a601efc4d4" ParentLink="Construct_MessageRef" LowerBound="303.39" HigherBound="303.52">
                                            <om:Property Name="Ref" Value="msgErrorEmail" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="5f9b0bc6-7730-4da7-8276-8f9514b59e2e" ParentLink="ComplexStatement_Statement" LowerBound="305.1" HigherBound="326.1">
                                            <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;PCFPeppolInvoiceReject&quot;,&quot;This invoice have multiple GR Numbers&quot;);&#xD;&#xA;&#xD;&#xA;varEmailBody = new System.Text.StringBuilder();&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;p&gt;PCFPeppol XML failed while processing in SESAMi.&lt;/p&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;p&gt;&lt;b&gt;&lt;u&gt;Error details:&lt;/u&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;InvoiceNo&lt;/b&gt; : &lt;i&gt;&quot; + varDocumentNumber + &quot;&lt;/i&gt;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;Error Description&lt;/b&gt; : &lt;i&gt;This invoice have multiple GR Numbers, Please resubmit the invoice with GR number only. Please refer to &lt;b&gt;InvoiceNow submission to PCF.pdf&lt;/b&gt; document sent by customercare@sesami.com&lt;/i&gt;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;msgErrorEmail.Body = new Sp.PCFPeppol.Common.RawString(varEmailBody.ToString());&#xD;&#xA;Sp.PCFPeppol.Common.SMTPUtils.SetContentType(msgErrorEmail.Body,&quot;text/html&quot;);&#xD;&#xA;Port_SndPCFPeppolXMLErrorEmail(Microsoft.XLANGs.BaseTypes.Address) = Sp.PCFPeppol.Common.SSOClientHelper.Read(&quot;Sp.PCFPeppol&quot;, &quot;SMTPTo&quot;);&#xD;&#xA;&#xD;&#xA;msgErrorEmail(SMTP.From) = Sp.PCFPeppol.Common.SSOClientHelper.Read(&quot;Sp.PCFPeppol&quot;, &quot;SMTPFrom&quot;);&#xD;&#xA;&#xD;&#xA;msgErrorEmail(SMTP.Subject) = &quot;PCFPeppol XML failed for InvoiceNo: &quot; + varDocumentNumber;&#xD;&#xA;&#xD;&#xA;msgErrorEmail(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;msgErrorEmail(SMTP.CC) = Sp.PCFPeppol.Common.SSOClientHelper.Read(&quot;Sp.PCFPeppol&quot;, &quot;SMTPCCopy&quot;);&#xD;&#xA;msgErrorEmail(SMTP.SMTPHost)= Sp.PCFPeppol.Common.SSOClientHelper.Read(&quot;Sp.PCFPeppol&quot;, &quot;SMTPHost&quot;);" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="2fa945b6-6fe0-4998-ad23-d3ddb88e3efe" ParentLink="ComplexStatement_Statement" LowerBound="327.1" HigherBound="329.1">
                                        <om:Property Name="PortName" Value="Port_SndPCFPeppolXMLErrorEmail" />
                                        <om:Property Name="MessageName" Value="msgErrorEmail" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_5" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="2bffe41e-e7a6-4f82-8392-5aa05a9d5447" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="VariableAssignment" OID="424aadb7-7899-44f2-8979-433d32c981d4" ParentLink="ComplexStatement_Statement" LowerBound="333.1" HigherBound="335.1">
                                <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;PCFPeppolXML_ErrorinStoreProc&quot;,varSPResp);" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Print_Response" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Catch" OID="6fc829a8-9221-4722-bc31-7304430afe8b" ParentLink="Scope_Catch" LowerBound="339.1" HigherBound="391.1">
                        <om:Property Name="ExceptionName" Value="ex" />
                        <om:Property Name="ExceptionType" Value="System.Exception" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="System.Exception" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="1b703215-a4bd-4e22-a427-9168cb1ff40d" ParentLink="Catch_Statement" LowerBound="342.1" HigherBound="358.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="const_ErrorLogsTable" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="9d8c9c08-935c-4b6a-976c-b41c0d1105a8" ParentLink="Construct_MessageRef" LowerBound="343.35" HigherBound="343.47">
                                <om:Property Name="Ref" Value="msgErrorLogs" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="294211b4-65ee-4b00-bca1-7b5bc6724851" ParentLink="ComplexStatement_Statement" LowerBound="345.1" HigherBound="357.1">
                                <om:Property Name="Expression" Value="&#xD;&#xA;varExceptionmsg = ex.Message;&#xD;&#xA;varExceptionmsg = varExceptionmsg.Replace(&quot;&amp;&quot;,&quot;&amp;amp;&quot;);&#xD;&#xA;varExceptionmsg = varExceptionmsg.Replace(&quot;'&quot;,&quot;''&quot;);&#xD;&#xA;varExceptionmsg = varExceptionmsg.Replace(&quot;&lt;&quot;,&quot;&amp;lt;&quot;);&#xD;&#xA;varExceptionmsg = varExceptionmsg.Replace(&quot;&gt;&quot;,&quot;&amp;gt;&quot;);&#xD;&#xA;varTempXML = new System.Xml.XmlDocument();&#xD;&#xA;varTempXML.LoadXml(&quot;&lt;ns0:InterfaceErrorLogs xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'&gt;&lt;ns0:HubID&gt;PCFPeppol&lt;/ns0:HubID&gt;&lt;ns0:DocumentID&gt;&quot; + varInstanceIdentifier + &quot;&lt;/ns0:DocumentID&gt;&lt;ns0:DocumentType&gt;PeppolXML&lt;/ns0:DocumentType&gt;&lt;ns0:DocumentNumber&gt;&quot; + varDocumentNumber + &quot;&lt;/ns0:DocumentNumber&gt;&lt;ns0:ModuleName&gt;Process_PeppolXML&lt;/ns0:ModuleName&gt;&lt;ns0:ExceptionType&gt;&quot; + ex.Source + &quot;&lt;/ns0:ExceptionType&gt;&lt;ns0:ErrorMessage&gt;&quot; + varExceptionmsg + &quot;&lt;/ns0:ErrorMessage&gt;&lt;ns0:VendorCode&gt;-&lt;/ns0:VendorCode&gt;&lt;ns0:DocumentPath&gt;-&lt;/ns0:DocumentPath&gt;&lt;/ns0:InterfaceErrorLogs&gt;&quot;);&#xD;&#xA;&#xD;&#xA;msgErrorLogs.Body = varTempXML;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_3" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="0c830520-652d-4e78-ad59-6a9bcb31d9e9" ParentLink="Catch_Statement" LowerBound="358.1" HigherBound="360.1">
                            <om:Property Name="PortName" Value="Port_SndPCFPeppolErrorLogs" />
                            <om:Property Name="MessageName" Value="msgErrorLogs" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_1" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Construct" OID="5dccade5-7d0e-44b9-a4e1-9778b7fd345a" ParentLink="Catch_Statement" LowerBound="360.1" HigherBound="388.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructMessage_2" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageAssignment" OID="46ee7efe-546d-41a4-b146-b68c20ffb87d" ParentLink="ComplexStatement_Statement" LowerBound="363.1" HigherBound="387.1">
                                <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;PCFPeppolException&quot;,ex.Message);&#xD;&#xA;&#xD;&#xA;varEmailBody = new System.Text.StringBuilder();&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;p&gt;PCFPeppol XML failed while processing in SESAMi.&lt;/p&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;p&gt;&lt;b&gt;&lt;u&gt;Error details:&lt;/u&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;Application Name&lt;/b&gt; : &lt;i&gt;Sp.PCFPeppol&lt;/i&gt;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;Process Name&lt;/b&gt; : &lt;i&gt;Process_PeppolXML&lt;/i&gt;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;DocumentNo&lt;/b&gt; : &lt;i&gt;&quot; + varDocumentNumber + &quot;&lt;/i&gt;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;Failure Code&lt;/b&gt; : &quot; + ex.Source + &quot;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;b&gt;Error Description&lt;/b&gt; : &lt;i&gt;&quot; + ex.Message + &quot;&lt;/i&gt;&lt;br/&gt;&quot;);&#xD;&#xA;varEmailBody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;msgErrorEmail.Body = new Sp.PCFPeppol.Common.RawString(varEmailBody.ToString());&#xD;&#xA;Sp.PCFPeppol.Common.SMTPUtils.SetContentType(msgErrorEmail.Body,&quot;text/html&quot;);&#xD;&#xA;Port_SndPCFPeppolXMLErrorEmail(Microsoft.XLANGs.BaseTypes.Address) = Sp.PCFPeppol.Common.SSOClientHelper.Read(&quot;Sp.PCFPeppol&quot;, &quot;SMTPTo&quot;);&#xD;&#xA;&#xD;&#xA;msgErrorEmail(SMTP.From) = Sp.PCFPeppol.Common.SSOClientHelper.Read(&quot;Sp.PCFPeppol&quot;, &quot;SMTPFrom&quot;);&#xD;&#xA;&#xD;&#xA;msgErrorEmail(SMTP.Subject) = &quot;PCFPeppol XML failed for DocNo: &quot; + varDocumentNumber;&#xD;&#xA;&#xD;&#xA;msgErrorEmail(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;msgErrorEmail(SMTP.CC) = Sp.PCFPeppol.Common.SSOClientHelper.Read(&quot;Sp.PCFPeppol&quot;, &quot;SMTPCCopy&quot;);&#xD;&#xA;msgErrorEmail(SMTP.SMTPHost)= Sp.PCFPeppol.Common.SSOClientHelper.Read(&quot;Sp.PCFPeppol&quot;, &quot;SMTPHost&quot;);" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_1" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="529489b3-ae64-4ca4-b5e4-431385bc373a" ParentLink="Construct_MessageRef" LowerBound="361.35" HigherBound="361.48">
                                <om:Property Name="Ref" Value="msgErrorEmail" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="a06edb6b-a1c6-4275-8d91-f7484c5c4c37" ParentLink="Catch_Statement" LowerBound="388.1" HigherBound="390.1">
                            <om:Property Name="PortName" Value="Port_SndPCFPeppolXMLErrorEmail" />
                            <om:Property Name="MessageName" Value="msgErrorEmail" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_2" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                </om:Element>
                <om:Element Type="VariableAssignment" OID="0dbba9e5-62b3-4a8a-96b4-c5f2f7122ca9" ParentLink="ServiceBody_Statement" LowerBound="393.1" HigherBound="395.1">
                    <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;PCFPeppol Process Complete&quot;,&quot;PCFPeppol Process Completeed&quot;);" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="ProcessEnd" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="4615a007-2146-45e9-8555-c53da9459e29" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="50.1" HigherBound="52.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.PCFPeppol.Orchestrations.PortType_RcvPCFPeppolXML" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_RcvPCFPeppolXML" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="d6b26eab-e67f-4a37-98c4-b23b1cec1420" ParentLink="PortDeclaration_CLRAttribute" LowerBound="50.1" HigherBound="51.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="491a0eb1-96df-42ab-aa81-848bb144a193" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="52.1" HigherBound="54.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="65" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.PCFPeppol.Orchestrations.PortType_SndRcvPCFPeppolStaging" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SndRcvPCFPeppolStaging" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="61054af1-a02d-443e-9b1c-09e674ea5dda" ParentLink="PortDeclaration_CLRAttribute" LowerBound="52.1" HigherBound="53.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="45c57792-7e63-49e3-9651-04fa62dc85fb" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="54.1" HigherBound="56.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="48" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.PCFPeppol.Orchestrations.PortType_SndPCFPeppolXML" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SndPCFPeppolXML" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="PhysicalBindingAttribute" OID="b623365a-34d4-4b27-8e97-cca1ed137b78" ParentLink="PortDeclaration_CLRAttribute" LowerBound="54.1" HigherBound="55.1">
                    <om:Property Name="InPipeline" Value="Microsoft.BizTalk.DefaultPipelines.XMLReceive" />
                    <om:Property Name="OutPipeline" Value="Sp.PCFPeppol.Pipelines.SndPeppolXML" />
                    <om:Property Name="TransportType" Value="HTTP" />
                    <om:Property Name="URI" Value="http://tempURI" />
                    <om:Property Name="IsDynamic" Value="True" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="cb0d630a-fe2f-45cb-99d3-f7f04b0571e9" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="56.1" HigherBound="58.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="132" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.PCFPeppol.Orchestrations.PortType_SndPCFPeppolErrorLogs" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SndPCFPeppolErrorLogs" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="b98cbd87-add1-43ee-b474-c80aa3c723ca" ParentLink="PortDeclaration_CLRAttribute" LowerBound="56.1" HigherBound="57.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="9dcc2af6-d710-431f-99d4-2a717fee6efe" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="58.1" HigherBound="60.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="116" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Sp.PCFPeppol.Orchestrations.PortType_SndPCFPeppolXMLErrorEmail" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SndPCFPeppolXMLErrorEmail" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="PhysicalBindingAttribute" OID="680dd8d4-4fe4-48ad-a3b1-ae36920e7042" ParentLink="PortDeclaration_CLRAttribute" LowerBound="58.1" HigherBound="59.1">
                    <om:Property Name="InPipeline" Value="Microsoft.BizTalk.DefaultPipelines.XMLReceive" />
                    <om:Property Name="OutPipeline" Value="Microsoft.BizTalk.DefaultPipelines.PassThruTransmit" />
                    <om:Property Name="TransportType" Value="HTTP" />
                    <om:Property Name="URI" Value="http://tempURI" />
                    <om:Property Name="IsDynamic" Value="True" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module Sp.PCFPeppol.Orchestrations
{
    internal messagetype MultiErrorEmail
    {
        body Sp.PCFPeppol.Common.RawString Body;
    };
    internal messagetype MultiErrorLogs
    {
        body Sp.PCFPeppol.Schemas.uspErrorLogs_TypedProcedure_docdata.InterfaceErrorLogs Body;
    };
    internal porttype PortType_RcvPCFPeppolXML
    {
        oneway Operation_1
        {
            Sp.PCFPeppol.Schemas.PeppolInput
        };
    };
    internal porttype PortType_SndPCFPeppolErrorLogs
    {
        oneway Operation_1
        {
            MultiErrorLogs
        };
    };
    internal porttype PortType_SndPCFPeppolXML
    {
        oneway Operation_1
        {
            Sp.PCFPeppol.Schemas.PeppolInput
        };
    };
    internal porttype PortType_SndRcvPCFPeppolStaging
    {
        requestresponse Operation_1
        {
            Sp.PCFPeppol.Schemas.uspPCFPeppolStaging_TypedProcedure_dbo.InterfacePCFPeppolStaging, Sp.PCFPeppol.Schemas.uspPCFPeppolStaging_TypedProcedure_dbo.InterfacePCFPeppolStagingResponse
        };
    };
    internal porttype PortType_SndPCFPeppolXMLErrorEmail
    {
        oneway Operation_1
        {
            MultiErrorEmail
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service Process_PCFPeppolStaging
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements PortType_RcvPCFPeppolXML Port_RcvPCFPeppolXML;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SndRcvPCFPeppolStaging Port_SndRcvPCFPeppolStaging;
        [Microsoft.XLANGs.BaseTypes.PhysicalBinding(typeof(Sp.PCFPeppol.Pipelines.SndPeppolXML))]
        port uses dynamic PortType_SndPCFPeppolXML Port_SndPCFPeppolXML;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SndPCFPeppolErrorLogs Port_SndPCFPeppolErrorLogs;
        [Microsoft.XLANGs.BaseTypes.PhysicalBinding(typeof(Microsoft.BizTalk.DefaultPipelines.PassThruTransmit))]
        port uses dynamic PortType_SndPCFPeppolXMLErrorEmail Port_SndPCFPeppolXMLErrorEmail;
        message MultiErrorLogs msgErrorLogs;
        message MultiErrorEmail msgErrorEmail;
        message Sp.PCFPeppol.Schemas.PeppolInput msgPeppolXML;
        message Sp.PCFPeppol.Schemas.uspPCFPeppolStaging_TypedProcedure_dbo.InterfacePCFPeppolStaging msguspReq;
        message Sp.PCFPeppol.Schemas.uspPCFPeppolStaging_TypedProcedure_dbo.InterfacePCFPeppolStagingResponse msguspResp;
        message Sp.PCFPeppol.Schemas.PeppolInput msgPeppolXMLCopy;
        message Sp.PCFPeppol.Schemas.PCFPeppolInternalXML msgInternalXML;
        System.String varTotalTaxAmount;
        System.Text.StringBuilder varEmailBody;
        System.String varAccCustEndpointId;
        System.String varAccSuppEndpointId;
        System.String varOrderReferenceId;
        System.String varInvoiceTypeCode;
        System.String varDocumentNumber;
        System.String varIssueDate;
        System.String varReceiverIdentifier;
        System.String varSenderIdentifier;
        System.String varUUID;
        System.String varInstanceIdentifier;
        System.Xml.XmlDocument varTempXML;
        System.String varSPResp;
        System.String varExceptionmsg;
        System.String varGRNNumber;
        System.String varFilePath;
        System.String varSenderRegName;
        System.String varReceiverRegName;
        System.String varDatetime;
        System.String varFullpath;
        System.String varTotalQty;
        System.String varTotalAmount;
        System.String varSupplierEmail;
        System.String varInvoiceHeaderText;
        System.String varCreditNoteInvRefNo;
        System.String varTaxExclusiveAmount;
        System.String varTaxInclusiveAmount;
        System.Int32 varInvLineCount;
        System.Int32 varchkGRCount;
        System.String varPreChkGRNo;
        System.Int32 varGRNCount;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("adfd31fc-001a-4f31-bda0-c5da854d44d2")]
            activate receive (Port_RcvPCFPeppolXML.Operation_1, msgPeppolXML);
            varTotalTaxAmount = "";
            varEmailBody = new System.Text.StringBuilder();
            varAccCustEndpointId = "";
            varAccSuppEndpointId = "";
            varOrderReferenceId = "";
            varInvoiceTypeCode = "";
            varDocumentNumber = "";
            varIssueDate = "";
            varReceiverIdentifier = "";
            varSenderIdentifier = "";
            varUUID = "";
            varInstanceIdentifier = "";
            varTempXML = new System.Xml.XmlDocument();
            varSPResp = "";
            varExceptionmsg = "";
            varGRNNumber = "";
            varFilePath = "";
            varSenderRegName = "";
            varReceiverRegName = "";
            varDatetime = "";
            varFullpath = "";
            varTotalQty = "";
            varTotalAmount = "";
            varSupplierEmail = "";
            varInvoiceHeaderText = "";
            varCreditNoteInvRefNo = "";
            varTaxExclusiveAmount = "";
            varTaxInclusiveAmount = "";
            varInvLineCount = 0;
            varchkGRCount = 0;
            varPreChkGRNo = "";
            varGRNCount = 0;
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("2690e6f3-01f3-4360-8a4a-c4e52639799c")]
            System.Diagnostics.EventLog.WriteEntry("PCFPeppol Process start","PCFPeppol Process started");
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("8d3eb18c-4db6-44d2-85cd-95f57fe46741")]
            scope
            {
                body
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f1f9d363-54c2-4954-899e-64c1d2b1aab8")]
                    construct msgInternalXML
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2b386416-41e0-4c13-8547-5d6bce21de8a")]
                        transform (msgInternalXML) = Sp.PCFPeppol.Transforms.Map_PeppolXML_PCFPeppolInternal (msgPeppolXML);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("af67d981-f8c3-4b95-bcb6-df7dfb1d85d7")]
                    varInstanceIdentifier = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='StandardBusinessDocumentHeader']/*[local-name()='DocumentIdentification']/*[local-name()='InstanceIdentifier'])");
                    varSenderIdentifier = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='StandardBusinessDocumentHeader']/*[local-name()='Sender']/*[local-name()='Identifier'])");
                    varSenderRegName = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='AccountingSupplierParty']/*[local-name()='Party']/*[local-name()='PartyLegalEntity']/*[local-name()='RegistrationName'])");
                    varReceiverIdentifier = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='StandardBusinessDocumentHeader']/*[local-name()='Receiver']/*[local-name()='Identifier'])");
                    varReceiverRegName = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='AccountingCustomerParty']/*[local-name()='Party']/*[local-name()='PartyLegalEntity']/*[local-name()='RegistrationName'])");
                    varUUID = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='UUID'])");
                    
                    varAccSuppEndpointId = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='AccountingSupplierParty']/*[local-name()='Party']/*[local-name()='PartyIdentification']/*[local-name()='ID'])");
                    varAccCustEndpointId = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='AccountingCustomerParty']/*[local-name()='Party']/*[local-name()='PartyIdentification']/*[local-name()='ID'])");
                    
                    varIssueDate = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='IssueDate'])");
                    varDocumentNumber = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='ID'])");
                    varInvoiceTypeCode = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='InvoiceTypeCode'])");
                    varOrderReferenceId = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='OrderReference']/*[local-name()='ID'])");
                    varGRNNumber = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='InvoiceLine']/*[local-name()='DocumentReference']/*[local-name()='ID'])");
                    varCreditNoteInvRefNo = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='BillingReference']/*[local-name()='InvoiceDocumentReference']/*[local-name()='ID'])");
                    varSupplierEmail = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='AccountingSupplierParty']/*[local-name()='Party']/*[local-name()='Contact']/*[local-name()='ElectronicMail'])");
                    varInvoiceHeaderText = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='Note'])");
                    
                    varTotalQty = xpath(msgInternalXML,"string(sum(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='InvoiceLine']/*[local-name()='InvoicedQuantity']))");
                    varTotalAmount = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='LegalMonetaryTotal']/*[local-name()='PayableAmount'])");
                    varTaxExclusiveAmount = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='LegalMonetaryTotal']/*[local-name()='TaxExclusiveAmount'])");
                    varTaxInclusiveAmount = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='LegalMonetaryTotal']/*[local-name()='TaxInclusiveAmount'])");
                    varTotalTaxAmount = xpath(msgInternalXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='TaxTotal']/*[local-name()='TaxAmount'])");
                    
                    if(System.Convert.ToString(Sp.PCFPeppol.Common.SSOClientHelper.Read("Sp.PCFPeppol", "ShowAdminLogs")) == "Yes")
                    {
                        varTempXML = new System.Xml.XmlDocument();
                        varTempXML = msgPeppolXML;
                        if(varTempXML.OuterXml.Length < 30000)
                        {
                            System.Diagnostics.EventLog.WriteEntry("msgpeppolxml",varTempXML.OuterXml);
                        }
                        else
                        {
                            System.Diagnostics.EventLog.WriteEntry("msgpeppolxml",varTempXML.OuterXml.Substring(1,29500));
                        }
                        varTempXML = new System.Xml.XmlDocument();
                        varTempXML = msgInternalXML;
                        if(varTempXML.OuterXml.Length < 30000)
                        {
                            System.Diagnostics.EventLog.WriteEntry("msgInternalXML",varTempXML.OuterXml);
                        }
                        else
                        {
                            System.Diagnostics.EventLog.WriteEntry("msgInternalXML",varTempXML.OuterXml.Substring(1,29500));
                        }
                        System.Diagnostics.EventLog.WriteEntry("varInstanceIdentifier",varInstanceIdentifier);
                        System.Diagnostics.EventLog.WriteEntry("varSenderIdentifier",varSenderIdentifier);
                        System.Diagnostics.EventLog.WriteEntry("SenderRegName",varSenderRegName);
                        System.Diagnostics.EventLog.WriteEntry("varReceiverIdentifier",varReceiverIdentifier);
                        System.Diagnostics.EventLog.WriteEntry("ReceiverRegName",varReceiverRegName);
                        System.Diagnostics.EventLog.WriteEntry("varUUID",varUUID);
                        System.Diagnostics.EventLog.WriteEntry("varAccSuppEndpointId",varAccSuppEndpointId);
                        System.Diagnostics.EventLog.WriteEntry("varAccCustEndpointId",varAccCustEndpointId);
                        System.Diagnostics.EventLog.WriteEntry("varIssueDate",varIssueDate);
                        System.Diagnostics.EventLog.WriteEntry("varDocumentNumber",varDocumentNumber);
                        System.Diagnostics.EventLog.WriteEntry("varInvoiceTypeCode",varInvoiceTypeCode);
                        System.Diagnostics.EventLog.WriteEntry("varOrderReferenceId",varOrderReferenceId);
                        System.Diagnostics.EventLog.WriteEntry("varGRNNumber",varGRNNumber);
                        System.Diagnostics.EventLog.WriteEntry("varCreditNoteInvRefNo",varCreditNoteInvRefNo);
                        System.Diagnostics.EventLog.WriteEntry("SupplierEmail",varSupplierEmail);
                        System.Diagnostics.EventLog.WriteEntry("InvoiceHeaderText",varInvoiceHeaderText);
                        System.Diagnostics.EventLog.WriteEntry("TotalQty",varTotalQty);
                        System.Diagnostics.EventLog.WriteEntry("TotalAmount",varTotalAmount);
                        System.Diagnostics.EventLog.WriteEntry("TotalTaxAmount",varTotalTaxAmount);
                        System.Diagnostics.EventLog.WriteEntry("TaxExclusiveAmount",varTaxExclusiveAmount);
                        System.Diagnostics.EventLog.WriteEntry("TaxInclusiveAmount",varTaxInclusiveAmount);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("93fa962f-7fc4-43f0-9d9f-30f3ebd2a453")]
                    varFilePath = Sp.PCFPeppol.Common.SSOClientHelper.Read("Sp.PCFPeppol", "PeppolXMLPath");
                    varDatetime = System.DateTime.Now.ToString("yyyyMMdd");
                    varFullpath = varFilePath + "\\" + varDatetime;
                    if (!System.IO.Directory.Exists(varFullpath))
                    {
                        System.IO.Directory.CreateDirectory(varFullpath);
                    }
                    Port_SndPCFPeppolXML(Microsoft.XLANGs.BaseTypes.Address)=@varFullpath + "\\"+varInstanceIdentifier+".xml";
                    Port_SndPCFPeppolXML(Microsoft.XLANGs.BaseTypes.TransportType)="FILE";
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("93c7ce36-9369-4c7a-81b6-a5a5256e2261")]
                    construct msgPeppolXMLCopy
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0573a798-c8c8-43fb-91da-cf4714a4ba0a")]
                        msgPeppolXMLCopy = msgPeppolXML;
                        msgPeppolXMLCopy(FILE.CopyMode) = 2; //overwrite;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("d28f5d37-d290-4330-88a3-4c81a4285813")]
                    send (Port_SndPCFPeppolXML.Operation_1, msgPeppolXMLCopy);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("ecf07bdc-70bd-42a9-bd2e-e0a9f21a2c65")]
                    construct msguspReq
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("83456d75-3708-4c73-b331-da95d7198796")]
                        varFullpath = varFullpath+ "\\"+varInstanceIdentifier+".xml";
                        varTempXML = new System.Xml.XmlDocument();
                        varTempXML.LoadXml("<ns0:InterfacePCFPeppolStaging xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'><ns0:InstanceIdentifier>" + varInstanceIdentifier + "</ns0:InstanceIdentifier><ns0:UUID>" + varUUID + "</ns0:UUID><ns0:SenderIdentifer>" + varSenderIdentifier + "</ns0:SenderIdentifer><ns0:SenderRegName>" + varSenderRegName + "</ns0:SenderRegName><ns0:ReceiverIdentifer>" + varReceiverIdentifier + "</ns0:ReceiverIdentifer><ns0:ReceiverRegName>" + varReceiverRegName + "</ns0:ReceiverRegName><ns0:IssueDate>" + varIssueDate + "</ns0:IssueDate><ns0:DocumentNumber>" + varDocumentNumber + "</ns0:DocumentNumber><ns0:InvoiceTypeCode>" + varInvoiceTypeCode + "</ns0:InvoiceTypeCode><ns0:OrderReferenceId>" + varOrderReferenceId + "</ns0:OrderReferenceId><ns0:GRNNumber>" + varGRNNumber + "</ns0:GRNNumber><ns0:AcctSuppPartyEndpointId>" + varAccSuppEndpointId + "</ns0:AcctSuppPartyEndpointId><ns0:AcctCustPartyEndpointId>" + varAccCustEndpointId + "</ns0:AcctCustPartyEndpointId><ns0:SupplierEmail>" + varSupplierEmail + "</ns0:SupplierEmail><ns0:InvoiceHeaderText>" + varInvoiceHeaderText + "</ns0:InvoiceHeaderText><ns0:CreditNoteInvRefNo>" + varCreditNoteInvRefNo + "</ns0:CreditNoteInvRefNo><ns0:TotalQty>" + varTotalQty + "</ns0:TotalQty><ns0:TotalAmount>" + varTotalAmount + "</ns0:TotalAmount><ns0:TaxExclusiveAmount>" + varTaxExclusiveAmount + "</ns0:TaxExclusiveAmount><ns0:TaxInclusiveAmount>" + varTaxInclusiveAmount + "</ns0:TaxInclusiveAmount><ns0:TotalTaxAmount>" + varTotalTaxAmount + "</ns0:TotalTaxAmount><ns0:PeppolXMLPath>" + varFullpath + "</ns0:PeppolXMLPath></ns0:InterfacePCFPeppolStaging>");
                        msguspReq = varTempXML;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b9e7b907-353c-4c59-a996-fa60b9cd5f0c")]
                    if(System.Convert.ToString(Sp.PCFPeppol.Common.SSOClientHelper.Read("Sp.PCFPeppol", "ShowAdminLogs")) == "Yes")
                    {
                        varTempXML = new System.Xml.XmlDocument();
                        varTempXML = msguspReq;    
                        if(varTempXML.OuterXml.Length < 30000)
                        {
                            System.Diagnostics.EventLog.WriteEntry("msguspReq",varTempXML.OuterXml);
                        }
                        else
                        {
                            System.Diagnostics.EventLog.WriteEntry("msguspReq",varTempXML.OuterXml.Substring(1,29500));
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b47ecb05-df53-4a83-8415-93a9fa6e18f8")]
                    send (Port_SndRcvPCFPeppolStaging.Operation_1, msguspReq);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("13ee63c2-8bdf-440c-bda2-c48d709e1492")]
                    receive (Port_SndRcvPCFPeppolStaging.Operation_1, msguspResp);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c91cfe06-ee10-4f70-8daa-2febe958abdc")]
                    if(System.Convert.ToString(Sp.PCFPeppol.Common.SSOClientHelper.Read("Sp.PCFPeppol", "ShowAdminLogs")) == "Yes")
                    {
                        varTempXML = new System.Xml.XmlDocument();
                        varTempXML = msguspResp;    
                        if(varTempXML.OuterXml.Length < 30000)
                        {
                            System.Diagnostics.EventLog.WriteEntry("msguspResp",varTempXML.OuterXml);
                        }
                        else
                        {
                            System.Diagnostics.EventLog.WriteEntry("msguspResp",varTempXML.OuterXml.Substring(1,29500));
                        }
                    }
                    varSPResp = xpath(msguspResp,"string(/*[local-name()='InterfacePCFPeppolStagingResponse']/*[local-name()='StoredProcedureResultSet1']/*[local-name()='StoredProcedureResultSet1']/*[local-name()='resDescription'])");
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f942b02a-3816-4ecc-818c-b32e68990f90")]
                    if (varSPResp == "OK")
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7cc95355-20a6-420b-b557-bdafe85f41d4")]
                        varInvLineCount = System.Convert.ToInt32(xpath(msgPeppolXML,"count(/*[local-name()='StandardBusinessDocument' and namespace-uri()='http://www.unece.org/cefact/namespaces/StandardBusinessDocumentHeader']/*[local-name()='Invoice' and namespace-uri()='urn:oasis:names:specification:ubl:schema:xsd:Invoice-2']/*[local-name()='InvoiceLine' and namespace-uri()='urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2'])"));
                        System.Diagnostics.EventLog.WriteEntry("InvoiceLineCount",varInvLineCount.ToString());
                        
                        //varInvLineCount = System.Convert.ToInt32(xpath(msgPeppolXML,"count(/*[local-name()='StandardBusinessDocument' and namespace-uri()='http://www.unece.org/cefact/namespaces/StandardBusinessDocumentHeader']/*[local-name()='CreditNote' and namespace-uri()='urn:oasis:names:specification:ubl:schema:xsd:CreditNote-2']/*[local-name()='CreditNoteLine' and namespace-uri()='urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2'])"));
                        //System.Diagnostics.EventLog.WriteEntry("CreditLineCount",varInvLineCount.ToString());
                        
                        varGRNNumber = xpath(msgPeppolXML,"string(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='InvoiceLine']/*[local-name()='DocumentReference']/*[local-name()='ID'])");
                        System.Diagnostics.EventLog.WriteEntry("GRNNumber",varGRNNumber);
                        
                        varGRNCount = System.Convert.ToInt32(xpath(msgPeppolXML,"count(/*[local-name()='StandardBusinessDocument']/*[local-name()='Invoice']/*[local-name()='InvoiceLine']/*[local-name()='DocumentReference']/*[local-name()='ID']/text()[contains(.,'" + varGRNNumber + "')])"));
                        System.Diagnostics.EventLog.WriteEntry("GRNCount",varGRNCount.ToString());
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7477369b-cc45-4018-957e-dea15d479f93")]
                        if ((((varInvLineCount > 0) & (varInvLineCount == varGRNCount)) || (varInvLineCount == 0) || (varGRNCount == 0)))
                        {
                        }
                        else 
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("62b9f7ab-5411-42f3-afc8-1a4388d23391")]
                            System.Diagnostics.EventLog.WriteEntry("GRN and Invoice Mismatch","GRN and Invoice Mismatch");
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("52583a1e-fe2b-45f0-a072-2a2b21fd2fbb")]
                            construct msgErrorEmail
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("5f9b0bc6-7730-4da7-8276-8f9514b59e2e")]
                                System.Diagnostics.EventLog.WriteEntry("PCFPeppolInvoiceReject","This invoice have multiple GR Numbers");
                                
                                varEmailBody = new System.Text.StringBuilder();
                                varEmailBody.AppendLine("<html><body>");
                                varEmailBody.AppendLine("<p>PCFPeppol XML failed while processing in SESAMi.</p>");
                                varEmailBody.AppendLine("<p><b><u>Error details:</u></b></p><p>");
                                varEmailBody.AppendLine("<b>InvoiceNo</b> : <i>" + varDocumentNumber + "</i><br/>");
                                varEmailBody.AppendLine("<b>Error Description</b> : <i>This invoice have multiple GR Numbers, Please resubmit the invoice with GR number only. Please refer to <b>InvoiceNow submission to PCF.pdf</b> document sent by customercare@sesami.com</i><br/>");
                                varEmailBody.AppendLine("</body></html>");
                                msgErrorEmail.Body = new Sp.PCFPeppol.Common.RawString(varEmailBody.ToString());
                                Sp.PCFPeppol.Common.SMTPUtils.SetContentType(msgErrorEmail.Body,"text/html");
                                Port_SndPCFPeppolXMLErrorEmail(Microsoft.XLANGs.BaseTypes.Address) = Sp.PCFPeppol.Common.SSOClientHelper.Read("Sp.PCFPeppol", "SMTPTo");
                                
                                msgErrorEmail(SMTP.From) = Sp.PCFPeppol.Common.SSOClientHelper.Read("Sp.PCFPeppol", "SMTPFrom");
                                
                                msgErrorEmail(SMTP.Subject) = "PCFPeppol XML failed for InvoiceNo: " + varDocumentNumber;
                                
                                msgErrorEmail(SMTP.EmailBodyFileCharset) = "UTF-8";
                                msgErrorEmail(SMTP.CC) = Sp.PCFPeppol.Common.SSOClientHelper.Read("Sp.PCFPeppol", "SMTPCCopy");
                                msgErrorEmail(SMTP.SMTPHost)= Sp.PCFPeppol.Common.SSOClientHelper.Read("Sp.PCFPeppol", "SMTPHost");
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("2fa945b6-6fe0-4998-ad23-d3ddb88e3efe")]
                            send (Port_SndPCFPeppolXMLErrorEmail.Operation_1, msgErrorEmail);
                        }
                    }
                    else 
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("424aadb7-7899-44f2-8979-433d32c981d4")]
                        System.Diagnostics.EventLog.WriteEntry("PCFPeppolXML_ErrorinStoreProc",varSPResp);
                    }
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6fc829a8-9221-4722-bc31-7304430afe8b")]
                    catch (System.Exception ex)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1b703215-a4bd-4e22-a427-9168cb1ff40d")]
                        construct msgErrorLogs
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("294211b4-65ee-4b00-bca1-7b5bc6724851")]
                            
                            varExceptionmsg = ex.Message;
                            varExceptionmsg = varExceptionmsg.Replace("&","&amp;");
                            varExceptionmsg = varExceptionmsg.Replace("'","''");
                            varExceptionmsg = varExceptionmsg.Replace("<","&lt;");
                            varExceptionmsg = varExceptionmsg.Replace(">","&gt;");
                            varTempXML = new System.Xml.XmlDocument();
                            varTempXML.LoadXml("<ns0:InterfaceErrorLogs xmlns:ns0='http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo'><ns0:HubID>PCFPeppol</ns0:HubID><ns0:DocumentID>" + varInstanceIdentifier + "</ns0:DocumentID><ns0:DocumentType>PeppolXML</ns0:DocumentType><ns0:DocumentNumber>" + varDocumentNumber + "</ns0:DocumentNumber><ns0:ModuleName>Process_PeppolXML</ns0:ModuleName><ns0:ExceptionType>" + ex.Source + "</ns0:ExceptionType><ns0:ErrorMessage>" + varExceptionmsg + "</ns0:ErrorMessage><ns0:VendorCode>-</ns0:VendorCode><ns0:DocumentPath>-</ns0:DocumentPath></ns0:InterfaceErrorLogs>");
                            
                            msgErrorLogs.Body = varTempXML;
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0c830520-652d-4e78-ad59-6a9bcb31d9e9")]
                        send (Port_SndPCFPeppolErrorLogs.Operation_1, msgErrorLogs);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("5dccade5-7d0e-44b9-a4e1-9778b7fd345a")]
                        construct msgErrorEmail
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("46ee7efe-546d-41a4-b146-b68c20ffb87d")]
                            System.Diagnostics.EventLog.WriteEntry("PCFPeppolException",ex.Message);
                            
                            varEmailBody = new System.Text.StringBuilder();
                            varEmailBody.AppendLine("<html><body>");
                            varEmailBody.AppendLine("<p>PCFPeppol XML failed while processing in SESAMi.</p>");
                            varEmailBody.AppendLine("<p><b><u>Error details:</u></b></p><p>");
                            varEmailBody.AppendLine("<b>Application Name</b> : <i>Sp.PCFPeppol</i><br/>");
                            varEmailBody.AppendLine("<b>Process Name</b> : <i>Process_PeppolXML</i><br/>");
                            varEmailBody.AppendLine("<b>DocumentNo</b> : <i>" + varDocumentNumber + "</i><br/>");
                            varEmailBody.AppendLine("<b>Failure Code</b> : " + ex.Source + "<br/>");
                            varEmailBody.AppendLine("<b>Error Description</b> : <i>" + ex.Message + "</i><br/>");
                            varEmailBody.AppendLine("</body></html>");
                            msgErrorEmail.Body = new Sp.PCFPeppol.Common.RawString(varEmailBody.ToString());
                            Sp.PCFPeppol.Common.SMTPUtils.SetContentType(msgErrorEmail.Body,"text/html");
                            Port_SndPCFPeppolXMLErrorEmail(Microsoft.XLANGs.BaseTypes.Address) = Sp.PCFPeppol.Common.SSOClientHelper.Read("Sp.PCFPeppol", "SMTPTo");
                            
                            msgErrorEmail(SMTP.From) = Sp.PCFPeppol.Common.SSOClientHelper.Read("Sp.PCFPeppol", "SMTPFrom");
                            
                            msgErrorEmail(SMTP.Subject) = "PCFPeppol XML failed for DocNo: " + varDocumentNumber;
                            
                            msgErrorEmail(SMTP.EmailBodyFileCharset) = "UTF-8";
                            msgErrorEmail(SMTP.CC) = Sp.PCFPeppol.Common.SSOClientHelper.Read("Sp.PCFPeppol", "SMTPCCopy");
                            msgErrorEmail(SMTP.SMTPHost)= Sp.PCFPeppol.Common.SSOClientHelper.Read("Sp.PCFPeppol", "SMTPHost");
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a06edb6b-a1c6-4275-8d91-f7484c5c4c37")]
                        send (Port_SndPCFPeppolXMLErrorEmail.Operation_1, msgErrorEmail);
                    }
                }
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0dbba9e5-62b3-4a8a-96b4-c5f2f7122ca9")]
            System.Diagnostics.EventLog.WriteEntry("PCFPeppol Process Complete","PCFPeppol Process Completeed");
        }
    }
}

